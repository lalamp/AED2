import networkx as nx
import matplotlib.pyplot as plt

class GrafoDFS:
    def __init__(self, grafo):
        self.grafo = grafo
        self.nodes_color = {node: 'white' for node in grafo.nodes}
        self.edges_visited = []

    def dfs(self, node):
        self.nodes_color[node] = 'gray'
        print('Cores dos nós:', self.nodes_color)

        # desenhar o grafo após a alteração de cor
        self.desenhar_grafo()

        for neighbor in self.grafo.neighbors(node):
            if self.nodes_color[neighbor] == 'white':
                print(f'\nAresta visitada: ({node}, {neighbor})')
                self.edges_visited.append((node, neighbor))
                self.dfs(neighbor)

        self.nodes_color[node] = 'black'
        print('Cores dos nós:', self.nodes_color)

        # desenhar o grafo após a alteração de cor
        self.desenhar_grafo()

    def percorrer_dfs(self):
        for node in self.grafo.nodes:
            if self.nodes_color[node] == 'white':
                print('Cores dos nós:', self.nodes_color)
                # desenhar o grafo antes do início do DFS
                self.desenhar_grafo()
                self.dfs(node)

    def desenhar_grafo(self):
        colors = [self.nodes_color[node] for node in self.grafo.nodes]
        edges_order = {(edge[0], edge[1]): j for j, edge in enumerate(grafo_dfs.edges_visited, start=1)}
        nx.draw(self.grafo, pos=nx.spring_layout(grafo, seed=42), with_labels=True, node_color=colors, font_color='red', cmap=plt.cm.Blues)
        nx.draw_networkx_edge_labels(grafo, pos=nx.spring_layout(grafo, seed=42), edge_labels=edges_order)
        plt.show()

# grafo com subgrafos não conectados
grafo = nx.Graph()
grafo.add_edges_from([(0, 1), (1, 2), (2, 0), (2, 3), (1, 4), (5, 6), (6, 7), (7, 9), (6, 8)])

# criar e percorrer GrafoDFS
print('Percurso DFS:')
grafo_dfs = GrafoDFS(grafo)
grafo_dfs.percorrer_dfs()

# imprimir resultados finais
print('\nCores finais dos nós:', grafo_dfs.nodes_color)
print('Arestas visitadas:', grafo_dfs.edges_visited)
print('Grafo final: ')
grafo_dfs.desenhar_grafo()